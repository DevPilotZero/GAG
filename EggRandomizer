--// Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")

--// GUI
local ScreenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "BloomScriptUI"

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 340, 0, 320)
MainFrame.Position = UDim2.new(0.5, -170, 0.5, -160)
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 150, 60)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 15)
MainCorner.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Text = "Pet ESP Randomizer"
Title.Font = Enum.Font.FredokaOne
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.Parent = MainFrame

--// Helper: Create Button
local function createButton(name, text, pos, color)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -20, 0, 40)
    btn.Position = pos
    btn.Text = text
    btn.BackgroundColor3 = color
    btn.Font = Enum.Font.FredokaOne
    btn.TextScaled = true
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Parent = MainFrame

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = btn
    return btn
end

-- Buttons
local ESPButton = createButton("ESPButton", "ESP: ON", UDim2.new(0, 10, 0, 80), Color3.fromRGB(0, 120, 200))
local RerollButton = createButton("RerollButton", "Reroll Egg", UDim2.new(0, 10, 0, 130), Color3.fromRGB(200, 150, 0))
local AutoRerollButton = createButton("AutoRerollButton", "Auto Reroll: OFF", UDim2.new(0, 10, 0, 180), Color3.fromRGB(150, 0, 150))

-- Signature
local Signature = Instance.new("TextLabel")
Signature.Size = UDim2.new(1, 0, 0, 20)
Signature.Position = UDim2.new(0, 0, 1, -20)
Signature.Text = "Made by BloomScript"
Signature.Font = Enum.Font.FredokaOne
Signature.TextColor3 = Color3.fromRGB(255, 255, 255)
Signature.TextScaled = true
Signature.Parent = MainFrame

--// ESP System
local ESP_ON = true
local ESP_Objects = {}

local function addESP(object)
    if not object:IsA("Model") or object:FindFirstChild("Head") then return end

    local part = object:FindFirstChildWhichIsA("BasePart")
    if not part then return end

    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 100, 0, 30)
    billboard.Adornee = part
    billboard.AlwaysOnTop = true
    billboard.Name = "EggESP"
    billboard.Parent = object

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextStrokeTransparency = 0
    label.Text = object.Name or "Egg"
    label.TextScaled = true
    label.Font = Enum.Font.FredokaOne
    label.Parent = billboard

    table.insert(ESP_Objects, billboard)
end

local function toggleESP(state)
    ESP_ON = state
    for _, obj in ipairs(ESP_Objects) do
        obj.Enabled = ESP_ON
    end
end

-- Scan workspace for eggs every few seconds
task.spawn(function()
    while task.wait(3) do
        if ESP_ON then
            for _, obj in ipairs(workspace:GetChildren()) do
                if obj:IsA("Model") and obj:FindFirstChildWhichIsA("BasePart") and not obj:FindFirstChild("EggESP") then
                    addESP(obj)
                end
            end
        end
    end
end)

-- ESP Toggle Button
ESPButton.MouseButton1Click:Connect(function()
    ESP_ON = not ESP_ON
    ESPButton.Text = "ESP: " .. (ESP_ON and "ON" or "OFF")
    toggleESP(ESP_ON)
end)

--// Reroll System (placeholder)
local AutoReroll = false

local function rerollEgg()
    -- Try calling server event (Replace this with actual remote path)
    print("[BloomScript] Reroll Egg called.")
    -- Example: game.ReplicatedStorage.Remotes.RerollEgg:FireServer()
end

RerollButton.MouseButton1Click:Connect(function()
    rerollEgg()
end)

AutoRerollButton.MouseButton1Click:Connect(function()
    AutoReroll = not AutoReroll
    AutoRerollButton.Text = "Auto Reroll: " .. (AutoReroll and "ON" or "OFF")
    if AutoReroll then
        task.spawn(function()
            while AutoReroll do
                rerollEgg()
                task.wait(1) -- reroll every 1 sec
            end
        end)
    end
end)

-- BloomScript Grow a Garden ESP + Reroll
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Create GUI
local ScreenGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
ScreenGui.Name = "BloomScriptUI"

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 340, 0, 300)
MainFrame.Position = UDim2.new(0.5, -170, 0.5, -150)
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 150, 60)
MainFrame.Active = true
MainFrame.Parent = ScreenGui

Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)

-- Draggable
local dragging, dragInput, startPos, startFramePos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        startPos = input.Position
        startFramePos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)
RunService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - startPos
        MainFrame.Position = UDim2.new(
            startFramePos.X.Scale,
            startFramePos.X.Offset + delta.X,
            startFramePos.Y.Scale,
            startFramePos.Y.Offset + delta.Y
        )
    end
end)

-- Title
local Title = Instance.new("TextLabel")
Title.Text = "Grow a Garden ESP"
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.FredokaOne
Title.TextColor3 = Color3.new(1, 1, 1)
Title.TextScaled = true
Title.Parent = MainFrame

-- Buttons
local function createBtn(name, text, pos, color)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Text = text
    btn.Size = UDim2.new(1, -20, 0, 40)
    btn.Position = pos
    btn.BackgroundColor3 = color
    btn.Font = Enum.Font.FredokaOne
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextScaled = true
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.Parent = MainFrame
    return btn
end

local ESPBtn = createBtn("ESPBtn","ESP: ON",UDim2.new(0,10,0,80),Color3.fromRGB(0,120,200))
local RerollBtn = createBtn("RerollBtn","Reroll Egg",UDim2.new(0,10,0,130),Color3.fromRGB(200,150,0))
local AutoRerollBtn = createBtn("AutoRerollBtn","Auto Reroll: OFF",UDim2.new(0,10,0,180),Color3.fromRGB(150,0,150))

-- ESP Logic
local ESP_ON = true
local ESP_List = {}

local function addESP(obj)
    if not obj:IsA("Model") or obj:FindFirstChild("ESP_TAG") then return end
    local part = obj:FindFirstChildWhichIsA("BasePart")
    if not part then return end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ESP_TAG"
    billboard.Size = UDim2.new(0,100,0,30)
    billboard.AlwaysOnTop = true
    billboard.Adornee = part
    billboard.Parent = obj

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1,0,1,0)
    label.BackgroundTransparency = 1
    label.Text = obj.Name
    label.TextColor3 = Color3.new(1,1,1)
    label.TextScaled = true
    label.Font = Enum.Font.FredokaOne
    label.Parent = billboard
    table.insert(ESP_List, billboard)
end

ESPBtn.MouseButton1Click:Connect(function()
    ESP_ON = not ESP_ON
    ESPBtn.Text = "ESP: " .. (ESP_ON and "ON" or "OFF")
    for _, b in ipairs(ESP_List) do b.Enabled = ESP_ON end
end)

task.spawn(function()
    while true do
        if ESP_ON then
            for _, obj in ipairs(workspace:GetChildren()) do
                if obj:IsA("Model") and string.find(string.lower(obj.Name), "egg") then
                    addESP(obj)
                end
            end
        end
        task.wait(2)
    end
end)

-- Reroll Logic
local AutoReroll = false
local function reroll()
    -- Attempt to fire Grow a Garden's reroll remote (if it exists)
    local success, event = pcall(function()
        return ReplicatedStorage:FindFirstChild("RerollEgg") or ReplicatedStorage:FindFirstChild("Events"):FindFirstChild("RerollEgg")
    end)
    if success and event and event:IsA("RemoteEvent") then
        event:FireServer()
    else
        print("[BloomScript] Reroll triggered (placeholder).")
    end
end

RerollBtn.MouseButton1Click:Connect(reroll)

AutoRerollBtn.MouseButton1Click:Connect(function()
    AutoReroll = not AutoReroll
    AutoRerollBtn.Text = "Auto Reroll: " .. (AutoReroll and "ON" or "OFF")
    if AutoReroll then
        task.spawn(function()
            while AutoReroll do
                reroll()
                task.wait(1)
            end
        end)
    end
end)

-- Signature
local Sign = Instance.new("TextLabel")
Sign.Text = "Made by BloomScript"
Sign.Size = UDim2.new(1, 0, 0, 20)
Sign.Position = UDim2.new(0, 0, 1, -20)
Sign.BackgroundTransparency = 1
Sign.Font = Enum.Font.FredokaOne
Sign.TextColor3 = Color3.new(1,1,1)
Sign.TextScaled = true
Sign.Parent = MainFrame
